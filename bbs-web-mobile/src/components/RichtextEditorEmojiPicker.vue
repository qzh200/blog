<!-- ÂØåÊñáÊú¨Ë°®ÊÉÖÈÄâÊã©Âô® -->
<template>
    <van-popup v-model:show="show_popup" class="richtextEditorEmojiPicker" :lock-scroll="false" position="bottom" :close-on-popstate="true" close-icon="close" :round="true" :closeable="true"  @closed="closed()">
        
        <van-loading v-if="show_loading" type="spinner" color="#1989fa" style="height: 100%;  display: flex;flex-direction: column;justify-content: center;align-items: center;"/>

        <div class="emoticon-container">
            <van-tabs v-model:active="state.type" swipeable >
                <!-- ÂõæÁâáË°®ÊÉÖ -->
                <van-tab :title="t('richtextEditorEmojiPicker.10')" :name="'image'">
                    <div class="emoticon-tab-content">
                        <div class="scroll">
                            <div class="emoticon-tab-item-container">
                                <span v-for="image in state.imageList" class="emoticon-tab-image-item" @click="onEmojiSelect(image,'image')">
                                    <img :src="image"/>
                                </span>
                            </div>
                        </div>
                    </div>
                </van-tab>
                <van-tab title="Emoji" :name="'emoji'">
                    <div class="emoticon-tab-content">
                        <div class="scroll">
                            <div class="emoticon-tab-item-container">
                                <span v-for="emoji in state.emojiList" class="emoticon-tab-emoji-item" @click="onEmojiSelect(emoji,'emoji')">
                                    <span class="emoji">{{emoji}}</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </van-tab>
            </van-tabs>
        </div>
    </van-popup>
</template>

<script setup lang="ts">
    import { nextTick, onMounted, reactive, ref} from 'vue'
    import { definePropType } from '@/utils/tool';
    import i18n from "@/locale/index";
    const { t } = i18n.global;

    const show_popup = ref(false);

    const show_loading = ref(false);

    const state = reactive({
        type :'image',//Á±ªÂûã image„ÄÅemoji
        imageList:[] as Array<string>,//ÂõæÁâáË°®ÊÉÖ
        emojiList:[] as Array<string>,//EmojiË°®ÊÉÖ
    });
   
    //Êé•Êî∂Áà∂ÁªÑ‰ª∂Ê∂àÊÅØ
    const props = defineProps({
        show: {
            type: Boolean,
            default: false
        },
        emojiPath: {
            type: String,
            default: false
        },
        onEmojiSelect: {//Ë°®ÊÉÖÁ¨¶Âè∑ÈÄâÊã©
            type: Function,
            default: null
        },
        close: {
            type: definePropType<() => void>(Function),
            required: true,
        }
      //  onClickOutside: {//Âú®ÈÄâÂèñÂô®Â§ñÈÉ®ÂèëÁîüÂçïÂáªÊó∂ÂõûË∞É
      //      type: Function,
      //      default: null
      //  },
    })  
    
   
    const handleCreateEmojiPicker = () => {
        show_popup.value = props.show;
        
        nextTick(()=>{
            show_loading.value = true;
                   
                    
            for(let i=0; i<152; i++){
                state.imageList.push(props.emojiPath+'pc/js/kindeditor/plugins/emoticons/twemoji/'+i+'.svg');
            }
            

            let emojis:any = {
                people: ['üòÄ','üòÉ','üòÑ','üòÅ','üòÜ','üòÖ','ü§£','üòÇ','üôÇ','üôÉ','üòâ','üòä','üòá','ü•∞','üòç','ü§©','üòò','üòó','üòö','üòô','üòã','üòõ','üòú','ü§™','üòù','ü§ë','ü§ó','ü§≠','ü§´','ü§î','ü§ê','ü§®','üòê','üòë','üò∂','üòè','üòí','üôÑ','üò¨','ü§•','üòå','üòî','üò™','ü§§','üò¥','üò∑','ü§í','ü§ï','ü§¢','ü§Æ','ü§ß','ü•µ','ü•∂','ü•¥','üòµ','ü§Ø','ü§†','ü•≥','üòé','ü§ì','üßê','üòï','üòü','üôÅ','‚òπÔ∏è','üòÆ','üòØ','üò≤','üò≥','ü•∫','üò¶','üòß','üò®','üò∞','üò•','üò¢','üò≠','üò±','üòñ','üò£','üòû','üòì','üò©','üò´','ü•±','üò§','üò°','üò†','ü§¨','üòà','üëø','üíÄ','‚ò†Ô∏è','üí©','ü§°','üëπ','üë∫','üëª','üëΩ','üëæ','ü§ñ','üëã','ü§ö','üñêÔ∏è','‚úã','üññ','üëå','ü§è','‚úåÔ∏è','ü§û','ü§ü','ü§ò','ü§ô','üëà','üëâ','üëÜ','üñï','üëá','‚òùÔ∏è','üëç','üëé','‚úä','üëä','ü§õ','ü§ú','üëè','üôå','üëê','ü§≤','ü§ù','üôè','‚úçÔ∏è','üíÖ','ü§≥','üí™','ü¶æ','ü¶ø','ü¶µ','ü¶∂','üëÇ','ü¶ª','üëÉ','üß†','ü¶∑','ü¶¥','üëÄ','üëÅÔ∏è','üëÖ','üëÑ','üò∫','üò∏','üòπ','üòª','üòº','üòΩ','üôÄ','üòø','üòæ','üôà','üôâ','üôä','üíã','üíå','üíò','üíù','üíñ','üíó','üíì','üíû','üíï','üíü','‚ù£Ô∏è','üíî','‚ù§Ô∏è','üíØ','üí¢','üí•','üí´','üí¶','üí®','üï≥Ô∏è','üí£','üí¨','üëÅÔ∏è‚Äçüó®Ô∏è','üó®Ô∏è','üóØÔ∏è','üí≠','üí§'],//Ë°®ÊÉÖ‰∏éËßíËâ≤
                nature: ['üêµ','üêí','ü¶ç','ü¶ß','üê∂','üêï','ü¶Æ','üêï‚Äçü¶∫','üê©','üê∫','ü¶ä','ü¶ù','üê±','üêà','ü¶Å','üêØ','üêÖ','üêÜ','üê¥','üêé','ü¶Ñ','ü¶ì','ü¶å','üêÆ','üêÇ','üêÉ','üêÑ','üê∑','üêñ','üêó','üêΩ','üêè','üêë','üêê','üê™','üê´','ü¶ô','ü¶í','üêò','ü¶è','ü¶õ','üê≠','üêÅ','üêÄ','üêπ','üêî','üêì','ü¶¢','üêç','üê≤','üêâ','ü¶ï','ü¶ñ','üê≥','üêã','üê¨','üêü','üê†','üê°','ü¶à','üêô','üêö','üêå','ü¶ã','üêõ','üêú','üêù','üêû','ü¶ó','üï∑Ô∏è','üï∏Ô∏è','ü¶Ç','ü¶ü','ü¶†','üíê','üåπ','ü•Ä','üå≤','üå≥','üå¥','üåµ','üçÅ'],//Âä®Áâ©‰∏éËá™ÁÑ∂
                foods: ['üçá','üçà','üçâ','üçä','üçã','üçå','üçç','ü•≠','üçé','üçè','üçê','üçë','üçí','üçì','ü•ù','üçÖ','ü••','ü•ë','üçÜ','ü•î','ü•ï','üåΩ','üå∂Ô∏è','ü•í','ü•¨','ü•¶','üßÑ','üßÖ','üçÑ','üçñ','üçó','ü¶Ä','ü¶û','ü¶ê','ü¶ë','ü•ß','üç´','üç¨','üç≠','üçÆ','üçØ','üçº','ü•õ','‚òï'],//È£üÁâ©‰∏éÈ•ÆÂìÅ
                activity: ['üéÉ','üéÑ','üéÜ','üß®','üéã','üßß','üéÄ','üéÅ','üéóÔ∏è','üéüÔ∏è','üé´','üéñÔ∏è','üèÜ','üèÖ','‚öΩ','‚öæ','ü•é','üèÄ','üÉè','üÄÑ','üé¥'],//Ê¥ªÂä®
                places: ['üèùÔ∏è','üèûÔ∏è','üèüÔ∏è','üèõÔ∏è','üèóÔ∏è','üß±','üè°','üè¢','üóº','üóΩ','üöë','üöí','üöì','üöî','üöï','üöñ','üöó','üö¢','‚úàÔ∏è','üõ∞Ô∏è','üöÄ','üõ∏','‚òÄÔ∏è','üåù','üåû','ü™ê','‚≠ê','üåü','üå†','üåÇ','‚ö°','‚ùÑÔ∏è','üî•','üíß'],//ÊóÖË°å‰∏éÊôØÁÇπ
                objects: ['üëì','üï∂Ô∏è','ü•Ω','ü•º','ü¶∫','üëî','üëï','üëñ','üß£','üß§','üß•','üß¶','üëó','üëò','ü•ª','ü©±','ü©≤','ü©≥','üëô','üëö','üëõ','üëú','üëù','üõçÔ∏è','üéí','üëû','üëü','ü•æ','ü•ø','üë†','üë°','ü©∞','üë¢','üëë','üëí','üé©','üéì','üß¢','‚õëÔ∏è','üìø','üíÑ','üíç','üíé','üîá','üîà','üîâ','üîä','üì¢','üì£','üìØ','üîî','üîï','üéº','üéµ','üé∂','üéôÔ∏è','üéöÔ∏è','üéõÔ∏è','üé§','üéß','üìª','üé∑','üé∏','üéπ','üé∫','üéª','ü™ï','ü•Å','üì±','üì≤','‚òéÔ∏è','üìû','üìü','üì†','üîã','üîå','üíª','üñ•Ô∏è','üñ®Ô∏è','‚å®Ô∏è','üñ±Ô∏è','üñ≤Ô∏è','üíΩ','üíæ','üíø','üìÄ','üßÆ','üé•','üéûÔ∏è','üìΩÔ∏è','üé¨','üì∫','üì∑','üì∏','üìπ','üìº','üîç','üîé','üïØÔ∏è','üí°','üî¶','üèÆ','ü™î','üìî','üìï','üìñ','üìó','üìò','üìô','üìö','üìì','üìí','üìÉ','üìú','üìÑ','üì∞','üóûÔ∏è','üìë','üîñ','üè∑Ô∏è','üí∞','üí¥','üíµ','üí∂','üí∑','üí∏','üí≥','üßæ','üíπ','‚úâÔ∏è','üìß','üì®','üì©','üì§','üì•','üì¶','üì´','üì™','üì¨','üì≠','üìÆ','üó≥Ô∏è','‚úèÔ∏è','‚úíÔ∏è','üñãÔ∏è','üñäÔ∏è','üñåÔ∏è','üñçÔ∏è','üìù','üíº','üìÅ','üìÇ','üóÇÔ∏è','üìÖ','üìÜ','üóíÔ∏è','üóìÔ∏è','üìá','üìà','üìâ','üìä','üìã','üìå','üìç','üìé','üñáÔ∏è','üìè','üìê','‚úÇÔ∏è','üóÉÔ∏è','üóÑÔ∏è','üóëÔ∏è','üîí','üîì','üîè','üîê','üîë','üóùÔ∏è','üî®','ü™ì','‚õèÔ∏è','‚öíÔ∏è','üõ†Ô∏è','üó°Ô∏è','‚öîÔ∏è','üî´','üèπ','üõ°Ô∏è','üîß','üî©','‚öôÔ∏è','üóúÔ∏è','‚öñÔ∏è','ü¶Ø','üîó','‚õìÔ∏è','üß∞','üß≤','‚öóÔ∏è','üß™','üß´','üß¨','üî¨','üî≠','üì°','üíâ','ü©∏','üíä','ü©π','ü©∫','üö™','üõèÔ∏è','üõãÔ∏è','ü™ë','üöΩ','üöø','üõÅ','ü™í','üß¥','üß∑','üßπ','üß∫','üßª','üßº','üßΩ','üßØ','üõí','üö¨','‚ö∞Ô∏è','‚ö±Ô∏è','üóø'],//Áâ©ÂìÅ
                symbols: ['üèß','üöπ','üö∫','üöª','üöæ','‚ö†Ô∏è','üö∏','‚õî','üö´','üö≥','üö≠','üöØ','üö±','üö∑','üìµ','üîû','‚ò¢Ô∏è','‚ò£Ô∏è','üîÖ','üîÜ','üì∂','üì≥','üì¥','‚úñÔ∏è','‚ûï','‚ûñ','‚ûó','‚ôæÔ∏è','‚ÄºÔ∏è','‚ÅâÔ∏è','‚ùì','‚ùî','‚ùï','‚ùó','„Ä∞Ô∏è','üí±','üí≤','‚öïÔ∏è','‚ôªÔ∏è','‚öúÔ∏è','‚≠ï','‚úÖ','‚úîÔ∏è','‚ùå','#Ô∏è‚É£','*Ô∏è‚É£','0Ô∏è‚É£','1Ô∏è‚É£','2Ô∏è‚É£','3Ô∏è‚É£','4Ô∏è‚É£','5Ô∏è‚É£','6Ô∏è‚É£','7Ô∏è‚É£','8Ô∏è‚É£','9Ô∏è‚É£','üîü','üÜó','üÖøÔ∏è','üÜò','üÜô','üÜö','üàÅ','üàÇÔ∏è','üà∑Ô∏è','üà∂','üàØ','üâê','üàπ','üàö','üà≤','üâë','üà∏','üà¥','üà≥','„äóÔ∏è','„äôÔ∏è','üà∫','üàµ'],//Á¨¶Âè∑
                flags: ['üèÅ','üéå','üö©','üè¥','üè≥Ô∏è']//ÊóóÂ∏ú 
            }

            for (let key in emojis) {
                state.emojiList.push(...emojis[key])
            }
            show_loading.value = false
            
        })

       


    };


    //Ë°®ÊÉÖÁ¨¶Âè∑ÈÄâÊã©
    const onEmojiSelect = (emoji: string,type:string ) => {
        //editor.txt.insertEmoticon("common/default/pc/js/kindeditor/plugins/emoticons/twemoji/9.svg", "image");
		//editor.txt.insertEmoticon("üòÑ", "emoji");
        props.onEmojiSelect(emoji,type);
        show_popup.value = false;
    };


    //ÂÖ≥Èó≠ÂºπÂá∫Â±Ç‰∏îÂä®ÁîªÁªìÊùüÂêéËß¶Âèë„ÄÇ
    const closed = () => {
        props.close();
    }

    onMounted(() => {
        handleCreateEmojiPicker();
       
    }) 
   
</script>

<style scoped lang="scss">
.emoticon-container{
    margin-top: 10px;
    width: 100%;
    height: 100%; 
    :deep(.van-tabs--line .van-tabs__wrap) {
        margin-left: var(--van-cell-group-inset-padding);
        margin-right: var(--van-cell-group-inset-padding);
        padding-bottom: 10px;
        background: #fff;
        border-radius: var(--van-cell-group-inset-border-radius) var(--van-cell-group-inset-border-radius) 0px 0px;
    }
    :deep(.van-cell-group--inset) {
        margin: 0px var(--van-cell-group-inset-padding);
        border-radius: 0px 0px var(--van-cell-group-inset-border-radius) var(--van-cell-group-inset-border-radius);
    }
    :deep(.van-tabs__line) {
        background: var(--van-blue);
    }
    .emoticon-tab-content{
        height: calc(57vh - 62px);
        .scroll{
            overflow-y:auto;
            -webkit-overflow-scrolling: touch;
            height: 100%; 
            .emoticon-tab-item-container{
                margin-top: 5px;
                margin-left: 5px;
                margin-right: 5px;
                margin-bottom: 5px;
                //display: flex;
                //justify-content: center; /* Ê∞¥Âπ≥Â±Ö‰∏≠ */
                //flex-wrap: wrap;
                .emoticon-tab-image-item {
                    cursor: pointer;
                    padding: 5px 10px;
                    display: inline-block;
                    img{
                        width: 32px;
                        height: 32px;
                    }
                }
            
                .emoticon-tab-emoji-item {
                    cursor: pointer;
                    
                    display: inline-block;
                    .emoji{
                        font-size: 30px;
                        width: 52px;
                        height: 52px;
                        display: inline-block;
                        text-align: center;
                    }
                }
                
            }
        }
        
    }
}
</style>
